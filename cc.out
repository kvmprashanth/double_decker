make -C /lib/modules/4.1.5/build M=/home/deba/tmem_module modules
make[1]: Entering directory `/home/deba/linux-4.1.3.changed'
  CC [M]  /home/deba/tmem_module/tcache.o
/home/deba/tmem_module/tcache.c: In function ‘utmem_pampd_create’:
/home/deba/tmem_module/tcache.c:85:4: error: implicit declaration of function ‘get_client_id_from_client’ [-Werror=implicit-function-declaration]
    int client_id = get_client_id_from_client(pool->client);   
    ^
/home/deba/tmem_module/tcache.c:86:37: error: ‘clients’ undeclared (first use in this function)
    struct client_details *client = &clients[client_id];
                                     ^
/home/deba/tmem_module/tcache.c:86:37: note: each undeclared identifier is reported only once for each function it appears in
In file included from include/linux/err.h:4:0,
                 from include/linux/kthread.h:4,
                 from /home/deba/tmem_module/tcache.c:1:
/home/deba/tmem_module/tcache.c:90:22: error: dereferencing pointer to incomplete type
    utmemassert(client->client_id == client_id);
                      ^
include/linux/compiler.h:164:42: note: in definition of macro ‘unlikely’
 # define unlikely(x) __builtin_expect(!!(x), 0)
                                          ^
/home/deba/tmem_module/tcache.c:90:4: note: in expansion of macro ‘utmemassert’
    utmemassert(client->client_id == client_id);
    ^
/home/deba/tmem_module/tcache.c:104:14: error: dereferencing pointer to incomplete type
    if(!client->bmap || !client->bmap->enabled)
              ^
/home/deba/tmem_module/tcache.c:104:31: error: dereferencing pointer to incomplete type
    if(!client->bmap || !client->bmap->enabled)
                               ^
/home/deba/tmem_module/tcache.c:108:10: error: dereferencing pointer to incomplete type
    client->total_puts++;
          ^
/home/deba/tmem_module/tcache.c:109:44: error: dereferencing pointer to incomplete type
    acc->last_access_time = jiffies - client->create_time;
                                            ^
/home/deba/tmem_module/tcache.c:111:8: error: ‘omnipresent_store_page’ undeclared (first use in this function)
    if(!omnipresent_store_page){
        ^
/home/deba/tmem_module/tcache.c:114:26: error: dereferencing pointer to incomplete type
    if(atomic_read(&client->total_pages) + LIMIT_THRESH >= client->bmap->limit
                          ^
/home/deba/tmem_module/tcache.c:114:65: error: dereferencing pointer to incomplete type
    if(atomic_read(&client->total_pages) + LIMIT_THRESH >= client->bmap->limit
                                                                 ^
/home/deba/tmem_module/tcache.c:115:11: error: ‘utmem_mem_thresh’ undeclared (first use in this function)
        || utmem_mem_thresh <= nr_free_pages() || atomic_read(&total_used) + LIMIT_THRESH >= max_global_limit)
           ^
/home/deba/tmem_module/tcache.c:115:63: error: ‘total_used’ undeclared (first use in this function)
        || utmem_mem_thresh <= nr_free_pages() || atomic_read(&total_used) + LIMIT_THRESH >= max_global_limit)
                                                               ^
/home/deba/tmem_module/tcache.c:115:93: error: ‘max_global_limit’ undeclared (first use in this function)
        || utmem_mem_thresh <= nr_free_pages() || atomic_read(&total_used) + LIMIT_THRESH >= max_global_limit)
                                                                                             ^
/home/deba/tmem_module/tcache.c:118:4: error: implicit declaration of function ‘oob_is_mergable’ [-Werror=implicit-function-declaration]
    type = oob_is_mergable(spage);
    ^
/home/deba/tmem_module/tcache.c:120:18: error: ‘PAGE_TEXT’ undeclared (first use in this function)
           type = PAGE_TEXT;   
                  ^
/home/deba/tmem_module/tcache.c:122:14: error: dereferencing pointer to incomplete type
    if((client->bmap->mode == MODE_SHARED || client->bmap->mode == MODE_MIXED) && type){
              ^
/home/deba/tmem_module/tcache.c:122:30: error: ‘MODE_SHARED’ undeclared (first use in this function)
    if((client->bmap->mode == MODE_SHARED || client->bmap->mode == MODE_MIXED) && type){
                              ^
/home/deba/tmem_module/tcache.c:122:51: error: dereferencing pointer to incomplete type
    if((client->bmap->mode == MODE_SHARED || client->bmap->mode == MODE_MIXED) && type){
                                                   ^
/home/deba/tmem_module/tcache.c:122:67: error: ‘MODE_MIXED’ undeclared (first use in this function)
    if((client->bmap->mode == MODE_SHARED || client->bmap->mode == MODE_MIXED) && type){
                                                                   ^
/home/deba/tmem_module/tcache.c:123:16: error: dereferencing pointer to incomplete type
       if(client->bmap->mode == MODE_SHARED){
                ^
/home/deba/tmem_module/tcache.c:128:14: error: implicit declaration of function ‘zcache_pampd_create’ [-Werror=implicit-function-declaration]
              opaque = zcache_pampd_create(data, size, raw, eph, pool, oid, index, tmem_obj);
              ^
/home/deba/tmem_module/tcache.c:128:21: warning: assignment makes pointer from integer without a cast [enabled by default]
              opaque = zcache_pampd_create(data, size, raw, eph, pool, oid, index, tmem_obj);
                     ^
/home/deba/tmem_module/tcache.c:130:21: error: ‘PAGE_COMP’ undeclared (first use in this function)
              type = PAGE_COMP; 
                     ^
/home/deba/tmem_module/tcache.c:134:32: error: dereferencing pointer to incomplete type
              atomic_inc(&client->compressed);
                                ^
/home/deba/tmem_module/tcache.c:138:4: error: implicit declaration of function ‘zcache_get_free_page’ [-Werror=implicit-function-declaration]
    page = zcache_get_free_page();
    ^
/home/deba/tmem_module/tcache.c:138:9: warning: assignment makes pointer from integer without a cast [enabled by default]
    page = zcache_get_free_page();
         ^
/home/deba/tmem_module/tcache.c:142:29: error: ‘KM_USER0’ undeclared (first use in this function)
    src = kmap_atomic(spage, KM_USER0);
                             ^
/home/deba/tmem_module/tcache.c:142:4: error: too many arguments to function ‘kmap_atomic’
    src = kmap_atomic(spage, KM_USER0);
    ^
In file included from /home/deba/tmem_module/utmem.h:14:0,
                 from /home/deba/tmem_module/tcache.c:5:
include/linux/highmem.h:66:21: note: declared here
 static inline void *kmap_atomic(struct page *page)
                     ^
/home/deba/tmem_module/tcache.c:147:31: error: macro "kunmap_atomic" passed 2 arguments, but takes just 1
    kunmap_atomic(src, KM_USER0);    
                               ^
/home/deba/tmem_module/tcache.c:147:4: error: ‘kunmap_atomic’ undeclared (first use in this function)
    kunmap_atomic(src, KM_USER0);    
    ^
/home/deba/tmem_module/tcache.c:149:4: error: implicit declaration of function ‘omnipresent_store_page’ [-Werror=implicit-function-declaration]
    if((opaque=omnipresent_store_page(client, pg)) == NULL) {
    ^
/home/deba/tmem_module/tcache.c:149:14: warning: assignment makes pointer from integer without a cast [enabled by default]
    if((opaque=omnipresent_store_page(client, pg)) == NULL) {
              ^
/home/deba/tmem_module/tcache.c:151:9: error: implicit declaration of function ‘zcache_free_page’ [-Werror=implicit-function-declaration]
         zcache_free_page(page);
         ^
/home/deba/tmem_module/tcache.c:154:14: error: ‘PAGE_SHARED_KSM’ undeclared (first use in this function)
   if(type == PAGE_SHARED_KSM){
              ^
/home/deba/tmem_module/tcache.c:156:26: error: dereferencing pointer to incomplete type
        atomic_inc(&client->shared);
                          ^
/home/deba/tmem_module/tcache.c:158:26: error: dereferencing pointer to incomplete type
        atomic_inc(&client->plain_text);
                          ^
/home/deba/tmem_module/tcache.c:161:44: error: ‘ZCACHE_GFP_MASK’ undeclared (first use in this function)
    n = kmem_cache_alloc(utmem_pampd_cache, ZCACHE_GFP_MASK);
                                            ^
/home/deba/tmem_module/tcache.c:172:22: error: dereferencing pointer to incomplete type
    atomic_inc(&client->total_pages); 
                      ^
/home/deba/tmem_module/tcache.c:175:26: error: dereferencing pointer to incomplete type
    if(atomic_read(&client->total_pages) + LIMIT_THRESH >= client->bmap->limit
                          ^
/home/deba/tmem_module/tcache.c:175:65: error: dereferencing pointer to incomplete type
    if(atomic_read(&client->total_pages) + LIMIT_THRESH >= client->bmap->limit
                                                                 ^
/home/deba/tmem_module/tcache.c:185:14: error: dereferencing pointer to incomplete type
        client->failed_puts++;
              ^
/home/deba/tmem_module/tcache.c: In function ‘utmem_pampd_get_data_and_free’:
/home/deba/tmem_module/tcache.c:208:37: error: ‘clients’ undeclared (first use in this function)
    struct client_details *client = &clients[client_id];
                                     ^
/home/deba/tmem_module/tcache.c:218:44: error: dereferencing pointer to incomplete type
    acc->last_access_time = jiffies - client->create_time;
                                            ^
In file included from include/linux/err.h:4:0,
                 from include/linux/kthread.h:4,
                 from /home/deba/tmem_module/tcache.c:1:
/home/deba/tmem_module/tcache.c:224:28: error: ‘PAGE_COMP’ undeclared (first use in this function)
    utmemassert(n->flags <= PAGE_COMP);
                            ^
include/linux/compiler.h:164:42: note: in definition of macro ‘unlikely’
 # define unlikely(x) __builtin_expect(!!(x), 0)
                                          ^
/home/deba/tmem_module/tcache.c:224:4: note: in expansion of macro ‘utmemassert’
    utmemassert(n->flags <= PAGE_COMP);
    ^
/home/deba/tmem_module/tcache.c:228:8: error: implicit declaration of function ‘zcache_pampd_get_data_and_free’ [-Werror=implicit-function-declaration]
        ret = zcache_pampd_get_data_and_free(data, bufsize, raw, n->object, pool, oid, index); 
        ^
/home/deba/tmem_module/tcache.c:231:26: error: dereferencing pointer to incomplete type
        atomic_dec(&client->compressed);
                          ^
/home/deba/tmem_module/tcache.c:233:26: error: ‘PAGE_SHARED_KSM’ undeclared (first use in this function)
     }else if(n->flags == PAGE_SHARED_KSM){
                          ^
/home/deba/tmem_module/tcache.c:235:26: error: dereferencing pointer to incomplete type
        atomic_dec(&client->shared);
                          ^
/home/deba/tmem_module/tcache.c:236:26: error: ‘PAGE_TEXT’ undeclared (first use in this function)
     }else if(n->flags == PAGE_TEXT)
                          ^
/home/deba/tmem_module/tcache.c:237:27: error: dereferencing pointer to incomplete type
         atomic_dec(&client->plain_text);
                           ^
/home/deba/tmem_module/tcache.c:239:8: error: ‘omnipresent_retrieve_page’ undeclared (first use in this function)
    if(!omnipresent_retrieve_page){
        ^
/home/deba/tmem_module/tcache.c:242:4: error: implicit declaration of function ‘omnipresent_retrieve_page’ [-Werror=implicit-function-declaration]
    if(omnipresent_retrieve_page(client, page, n->object, 1)){
    ^
/home/deba/tmem_module/tcache.c:251:22: error: dereferencing pointer to incomplete type
    atomic_dec(&client->total_pages);
                      ^
/home/deba/tmem_module/tcache.c:252:16: error: ‘total_used’ undeclared (first use in this function)
    atomic_dec(&total_used);
                ^
/home/deba/tmem_module/tcache.c: In function ‘utmem_pampd_free’:
/home/deba/tmem_module/tcache.c:263:37: error: ‘clients’ undeclared (first use in this function)
    struct client_details *client = &clients[client_id];
                                     ^
In file included from include/linux/err.h:4:0,
                 from include/linux/kthread.h:4,
                 from /home/deba/tmem_module/tcache.c:1:
/home/deba/tmem_module/tcache.c:277:28: error: ‘PAGE_COMP’ undeclared (first use in this function)
    utmemassert(n->flags <= PAGE_COMP);
                            ^
include/linux/compiler.h:164:42: note: in definition of macro ‘unlikely’
 # define unlikely(x) __builtin_expect(!!(x), 0)
                                          ^
/home/deba/tmem_module/tcache.c:277:4: note: in expansion of macro ‘utmemassert’
    utmemassert(n->flags <= PAGE_COMP);
    ^
/home/deba/tmem_module/tcache.c:280:8: error: implicit declaration of function ‘zcache_pampd_free’ [-Werror=implicit-function-declaration]
        zcache_pampd_free(n->object, pool, oid, index); 
        ^
/home/deba/tmem_module/tcache.c:282:26: error: dereferencing pointer to incomplete type
        atomic_dec(&client->compressed);
                          ^
/home/deba/tmem_module/tcache.c:284:26: error: ‘PAGE_SHARED_KSM’ undeclared (first use in this function)
     }else if(n->flags == PAGE_SHARED_KSM){
                          ^
/home/deba/tmem_module/tcache.c:286:26: error: dereferencing pointer to incomplete type
        atomic_dec(&client->shared);
                          ^
/home/deba/tmem_module/tcache.c:287:26: error: ‘PAGE_TEXT’ undeclared (first use in this function)
     }else if(n->flags == PAGE_TEXT)
                          ^
/home/deba/tmem_module/tcache.c:288:27: error: dereferencing pointer to incomplete type
         atomic_dec(&client->plain_text);
                           ^
/home/deba/tmem_module/tcache.c:290:8: error: ‘omnipresent_remove_mapping’ undeclared (first use in this function)
    if(!omnipresent_remove_mapping)
        ^
/home/deba/tmem_module/tcache.c:292:4: error: implicit declaration of function ‘omnipresent_remove_mapping’ [-Werror=implicit-function-declaration]
    omnipresent_remove_mapping(client, n->object);
    ^
/home/deba/tmem_module/tcache.c:298:22: error: dereferencing pointer to incomplete type
    atomic_dec(&client->total_pages);
                      ^
/home/deba/tmem_module/tcache.c:299:16: error: ‘total_used’ undeclared (first use in this function)
    atomic_dec(&total_used);
                ^
/home/deba/tmem_module/tcache.c: In function ‘utmem_pampd_free_obj’:
/home/deba/tmem_module/tcache.c:307:37: error: ‘clients’ undeclared (first use in this function)
    struct client_details *client = &clients[client_id];
                                     ^
In file included from include/linux/err.h:4:0,
                 from include/linux/kthread.h:4,
                 from /home/deba/tmem_module/tcache.c:1:
/home/deba/tmem_module/tcache.c:309:22: error: dereferencing pointer to incomplete type
    utmemassert(client->client_id == client_id);
                      ^
include/linux/compiler.h:164:42: note: in definition of macro ‘unlikely’
 # define unlikely(x) __builtin_expect(!!(x), 0)
                                          ^
/home/deba/tmem_module/tcache.c:309:4: note: in expansion of macro ‘utmemassert’
    utmemassert(client->client_id == client_id);
    ^
/home/deba/tmem_module/tcache.c:312:22: error: dereferencing pointer to incomplete type
    atomic_dec(&client->num_tmem_objs);
                      ^
/home/deba/tmem_module/tcache.c: In function ‘utmem_pampd_new_obj’:
/home/deba/tmem_module/tcache.c:321:37: error: ‘clients’ undeclared (first use in this function)
    struct client_details *client = &clients[client_id];
                                     ^
In file included from include/linux/err.h:4:0,
                 from include/linux/kthread.h:4,
                 from /home/deba/tmem_module/tcache.c:1:
/home/deba/tmem_module/tcache.c:323:22: error: dereferencing pointer to incomplete type
    utmemassert(client->client_id == client_id);
                      ^
include/linux/compiler.h:164:42: note: in definition of macro ‘unlikely’
 # define unlikely(x) __builtin_expect(!!(x), 0)
                                          ^
/home/deba/tmem_module/tcache.c:323:4: note: in expansion of macro ‘utmemassert’
    utmemassert(client->client_id == client_id);
    ^
/home/deba/tmem_module/tcache.c:324:47: error: ‘ZCACHE_GFP_MASK’ undeclared (first use in this function)
    acc = kmem_cache_alloc(utmem_tmemex_cache, ZCACHE_GFP_MASK);
                                               ^
/home/deba/tmem_module/tcache.c:329:22: error: dereferencing pointer to incomplete type
    atomic_inc(&client->num_tmem_objs);
                      ^
/home/deba/tmem_module/tcache.c: At top level:
/home/deba/tmem_module/tcache.c:413:35: warning: ‘struct client_details’ declared inside parameter list [enabled by default]
                            struct evict_object *samples, int *max_count)
                                   ^
/home/deba/tmem_module/tcache.c:413:35: warning: its scope is only this definition or declaration, which is probably not what you want [enabled by default]
/home/deba/tmem_module/tcache.c: In function ‘evict_from_pool_oldies’:
/home/deba/tmem_module/tcache.c:361:77: error: dereferencing pointer to incomplete type
 #define is_old_enough(client, extra) (( (extra)->last_access_time + (client)->create_time + REALLY_OLD) <= jiffies ? true : false)
                                                                             ^
/home/deba/tmem_module/tcache.c:430:31: note: in expansion of macro ‘is_old_enough’
                            if(is_old_enough(client,acc)){
                               ^
/home/deba/tmem_module/tcache.c:438:55: error: dereferencing pointer to incomplete type
                                score_insert_obj(client->create_time, samples, *max_count, obj, hb);
                                                       ^
/home/deba/tmem_module/tcache.c: At top level:
/home/deba/tmem_module/tcache.c:452:30: warning: ‘struct client_details’ declared inside parameter list [enabled by default]
 int evict_from_client(struct client_details *client, int total, int used)
                              ^
/home/deba/tmem_module/tcache.c: In function ‘evict_from_client’:
/home/deba/tmem_module/tcache.c:463:20: error: dereferencing pointer to incomplete type
    zclient = client->pclient;
                    ^
/home/deba/tmem_module/tcache.c:487:40: error: dereferencing pointer to incomplete type
        struct tmem_pool *pool = zclient->tmem_pools[poolid];
                                        ^
/home/deba/tmem_module/tcache.c:489:18: warning: passing argument 1 of ‘evict_from_pool_oldies’ from incompatible pointer type [enabled by default]
                  ret += evict_from_pool_oldies(client, pool, &total, &used, object, &obj_count);
                  ^
/home/deba/tmem_module/tcache.c:412:5: note: expected ‘struct client_details *’ but argument is of type ‘struct client_details *’
 int evict_from_pool_oldies(struct client_details *client, struct tmem_pool *pool, int *total, int *used, 
     ^
In file included from include/linux/err.h:4:0,
                 from include/linux/kthread.h:4,
                 from /home/deba/tmem_module/tcache.c:1:
/home/deba/tmem_module/tcache.c:506:54: error: dereferencing pointer to incomplete type
                     || ev->obj->pool->client!= client->pclient)){
                                                      ^
include/linux/compiler.h:164:42: note: in definition of macro ‘unlikely’
 # define unlikely(x) __builtin_expect(!!(x), 0)
                                          ^
/home/deba/tmem_module/tcache.c:542:40: error: dereferencing pointer to incomplete type
        struct tmem_pool *pool = zclient->tmem_pools[poolid];
                                        ^
/home/deba/tmem_module/tcache.c:555:51: error: dereferencing pointer to incomplete type
                            score_insert_obj(client->create_time, object, obj_count, obj, hb);
                                                   ^
/home/deba/tmem_module/tcache.c: At top level:
/home/deba/tmem_module/tcache.c:577:39: error: ‘MAX_CLIENTS’ undeclared here (not in a function)
                       struct evict ev[MAX_CLIENTS];
                                       ^
/home/deba/tmem_module/tcache.c: In function ‘client_score’:
/home/deba/tmem_module/tcache.c:584:27: error: dereferencing pointer to incomplete type
    w = atomic_read(&client->total_pages);
                           ^
/home/deba/tmem_module/tcache.c:585:27: error: dereferencing pointer to incomplete type
    c = atomic_read(&client->compressed);
                           ^
/home/deba/tmem_module/tcache.c:586:27: error: dereferencing pointer to incomplete type
    t = atomic_read(&client->plain_text);
                           ^
/home/deba/tmem_module/tcache.c:588:14: error: ‘MUSAGE_FACTOR’ undeclared (first use in this function)
    score += (MUSAGE_FACTOR * w ) / (client->bmap->limit+1);
              ^
/home/deba/tmem_module/tcache.c:588:43: error: dereferencing pointer to incomplete type
    score += (MUSAGE_FACTOR * w ) / (client->bmap->limit+1);
                                           ^
/home/deba/tmem_module/tcache.c:590:14: error: ‘SH_FACTOR’ undeclared (first use in this function)
    score += (SH_FACTOR * (c+t)) / (w+1);
              ^
/home/deba/tmem_module/tcache.c:592:14: error: ‘RW_FACTOR’ undeclared (first use in this function)
    score += (RW_FACTOR * (client->pclient->succ_flushes)) / (client->pclient->succ_gets + client->pclient->succ_flushes + 1);  
              ^
/home/deba/tmem_module/tcache.c:592:33: error: dereferencing pointer to incomplete type
    score += (RW_FACTOR * (client->pclient->succ_flushes)) / (client->pclient->succ_gets + client->pclient->succ_flushes + 1);  
                                 ^
/home/deba/tmem_module/tcache.c:592:68: error: dereferencing pointer to incomplete type
    score += (RW_FACTOR * (client->pclient->succ_flushes)) / (client->pclient->succ_gets + client->pclient->succ_flushes + 1);  
                                                                    ^
/home/deba/tmem_module/tcache.c:592:97: error: dereferencing pointer to incomplete type
    score += (RW_FACTOR * (client->pclient->succ_flushes)) / (client->pclient->succ_gets + client->pclient->succ_flushes + 1);  
                                                                                                 ^
/home/deba/tmem_module/tcache.c: In function ‘do_eviction_plan’:
/home/deba/tmem_module/tcache.c:617:19: error: ‘total_used’ undeclared (first use in this function)
   if(atomic_read(&total_used) + LIMIT_THRESH >= max_global_limit)
                   ^
/home/deba/tmem_module/tcache.c:617:49: error: ‘max_global_limit’ undeclared (first use in this function)
   if(atomic_read(&total_used) + LIMIT_THRESH >= max_global_limit)
                                                 ^
/home/deba/tmem_module/tcache.c:623:24: error: ‘clients’ undeclared (first use in this function)
                     if(clients[i].client_id == -1 || clients[i].bmap == NULL){
                        ^
/home/deba/tmem_module/tcache.c:630:42: error: dereferencing pointer to incomplete type
                    if(atomic_read(&client->total_pages) + LIMIT_THRESH >= client->bmap->limit){
                                          ^
/home/deba/tmem_module/tcache.c:630:81: error: dereferencing pointer to incomplete type
                    if(atomic_read(&client->total_pages) + LIMIT_THRESH >= client->bmap->limit){
                                                                                 ^
In file included from include/linux/sched.h:17:0,
                 from include/linux/kthread.h:5,
                 from /home/deba/tmem_module/tcache.c:1:
/home/deba/tmem_module/tcache.c:631:98: error: dereferencing pointer to incomplete type
                           plan->ev[i].total_to_evict += max(8 * LIMIT_THRESH, atomic_read(&client->total_pages) + LIMIT_THRESH - client->bmap->limit);
                                                                                                  ^
include/linux/kernel.h:728:9: note: in definition of macro ‘max’
  typeof(y) _max2 = (y);   \
         ^
/home/deba/tmem_module/tcache.c:631:136: error: dereferencing pointer to incomplete type
                           plan->ev[i].total_to_evict += max(8 * LIMIT_THRESH, atomic_read(&client->total_pages) + LIMIT_THRESH - client->bmap->limit);
                                                                                                                                        ^
include/linux/kernel.h:728:9: note: in definition of macro ‘max’
  typeof(y) _max2 = (y);   \
         ^
/home/deba/tmem_module/tcache.c:631:98: error: dereferencing pointer to incomplete type
                           plan->ev[i].total_to_evict += max(8 * LIMIT_THRESH, atomic_read(&client->total_pages) + LIMIT_THRESH - client->bmap->limit);
                                                                                                  ^
include/linux/kernel.h:728:21: note: in definition of macro ‘max’
  typeof(y) _max2 = (y);   \
                     ^
/home/deba/tmem_module/tcache.c:631:136: error: dereferencing pointer to incomplete type
                           plan->ev[i].total_to_evict += max(8 * LIMIT_THRESH, atomic_read(&client->total_pages) + LIMIT_THRESH - client->bmap->limit);
                                                                                                                                        ^
include/linux/kernel.h:728:21: note: in definition of macro ‘max’
  typeof(y) _max2 = (y);   \
                     ^
/home/deba/tmem_module/tcache.c:612:21: warning: unused variable ‘sb’ [-Wunused-variable]
   struct scoreboard sb[MAX_CLIENTS];
                     ^
/home/deba/tmem_module/tcache.c: In function ‘utmem_evict_pages’:
/home/deba/tmem_module/tcache.c:679:3: error: ‘total_evicted’ undeclared (first use in this function)
   total_evicted += evictions; 
   ^
/home/deba/tmem_module/tcache.c: In function ‘evict_from_pool_useless’:
/home/deba/tmem_module/tcache.c:684:75: error: dereferencing pointer to incomplete type
 #define is_very_old(client, extra) (( (extra)->last_access_time + (client)->create_time + USELESS) <= jiffies ? true : false)
                                                                           ^
/home/deba/tmem_module/tcache.c:702:31: note: in expansion of macro ‘is_very_old’
                            if(is_very_old(client, acc)){
                               ^
/home/deba/tmem_module/tcache.c: In function ‘evict_useless’:
/home/deba/tmem_module/tcache.c:720:24: error: ‘clients’ undeclared (first use in this function)
                     if(clients[i].client_id == -1){
                        ^
/home/deba/tmem_module/tcache.c:724:37: error: dereferencing pointer to incomplete type
                     zclient = client->pclient;
                                     ^
/home/deba/tmem_module/tcache.c:727:60: error: dereferencing pointer to incomplete type
                            struct tmem_pool *pool = zclient->tmem_pools[poolid];
                                                            ^
/home/deba/tmem_module/tcache.c:731:39: error: ‘total_evicted’ undeclared (first use in this function)
                                       total_evicted += ret;
                                       ^
/home/deba/tmem_module/tcache.c:732:45: error: dereferencing pointer to incomplete type
                                       client->evictions += ret; 
                                             ^
/home/deba/tmem_module/tcache.c: At top level:
/home/deba/tmem_module/tcache.c:756:9: error: unknown field ‘shrink’ specified in initializer
         .shrink = shrink_utmem_memory,
         ^
/home/deba/tmem_module/tcache.c:756:9: warning: initialization from incompatible pointer type [enabled by default]
/home/deba/tmem_module/tcache.c:756:9: warning: (near initialization for ‘utmem_shrinker.count_objects’) [enabled by default]
/home/deba/tmem_module/tcache.c: In function ‘client_score_entitlement’:
/home/deba/tmem_module/tcache.c:763:27: error: dereferencing pointer to incomplete type
    w = atomic_read(&client->total_pages);
                           ^
/home/deba/tmem_module/tcache.c:764:28: error: dereferencing pointer to incomplete type
    sh = atomic_read(&client->shared);
                            ^
/home/deba/tmem_module/tcache.c:766:21: error: dereferencing pointer to incomplete type
    score[0] = client->bmap->limit + 1;
                     ^
/home/deba/tmem_module/tcache.c:767:29: error: dereferencing pointer to incomplete type
    score[1] = (100 * (client->pclient->succ_gets)) / (client->pclient->succ_gets + client->pclient->succ_flushes + 1);  
                             ^
/home/deba/tmem_module/tcache.c:767:61: error: dereferencing pointer to incomplete type
    score[1] = (100 * (client->pclient->succ_gets)) / (client->pclient->succ_gets + client->pclient->succ_flushes + 1);  
                                                             ^
/home/deba/tmem_module/tcache.c:767:90: error: dereferencing pointer to incomplete type
    score[1] = (100 * (client->pclient->succ_gets)) / (client->pclient->succ_gets + client->pclient->succ_flushes + 1);  
                                                                                          ^
/home/deba/tmem_module/tcache.c: In function ‘global_eviction_plan’:
/home/deba/tmem_module/tcache.c:785:19: error: ‘total_used’ undeclared (first use in this function)
   if(atomic_read(&total_used) + LIMIT_THRESH < max_global_limit)
                   ^
/home/deba/tmem_module/tcache.c:785:48: error: ‘max_global_limit’ undeclared (first use in this function)
   if(atomic_read(&total_used) + LIMIT_THRESH < max_global_limit)
                                                ^
/home/deba/tmem_module/tcache.c:790:12: error: ‘clients’ undeclared (first use in this function)
         if(clients[i].client_id == -1 || clients[i].bmap == NULL){
            ^
/home/deba/tmem_module/tcache.c:807:56: error: ‘MUSAGE_FACTOR’ undeclared (first use in this function)
                    unsigned wScore = (sb[i].score[0] * MUSAGE_FACTOR) / (total_score[0] + 1) +
                                                        ^
/home/deba/tmem_module/tcache.c:808:56: error: ‘RW_FACTOR’ undeclared (first use in this function)
                                      (sb[i].score[1] * RW_FACTOR) / (total_score[1] + 1)+
                                                        ^
/home/deba/tmem_module/tcache.c:809:56: error: ‘SH_FACTOR’ undeclared (first use in this function)
                                      (sb[i].score[2] * SH_FACTOR) / (total_score[2] + 1);
                                                        ^
/home/deba/tmem_module/tcache.c:814:20: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
                    int evict = atomic_read(&sb[i].pclient->total_pages) - entitlement;
                    ^
/home/deba/tmem_module/tcache.c:781:21: warning: unused variable ‘sb’ [-Wunused-variable]
   struct scoreboard sb[MAX_CLIENTS];
                     ^
/home/deba/tmem_module/tcache.c: In function ‘enforce_global_limit’:
/home/deba/tmem_module/tcache.c:839:3: error: ‘total_evicted’ undeclared (first use in this function)
   total_evicted += evictions; 
   ^
/home/deba/tmem_module/tcache.c: In function ‘omp_eviction_kthread’:
/home/deba/tmem_module/tcache.c:850:49: error: ‘utmem_mem_thresh’ undeclared (first use in this function)
           if(start_evict && nr_free_pages()  <= utmem_mem_thresh ){
                                                 ^
/home/deba/tmem_module/tcache.c:852:48: error: ‘total_used’ undeclared (first use in this function)
           }else if(start_evict && atomic_read(&total_used) + LIMIT_THRESH >= max_global_limit){
                                                ^
/home/deba/tmem_module/tcache.c:852:78: error: ‘max_global_limit’ undeclared (first use in this function)
           }else if(start_evict && atomic_read(&total_used) + LIMIT_THRESH >= max_global_limit){
                                                                              ^
/home/deba/tmem_module/tcache.c: In function ‘init_utmem’:
/home/deba/tmem_module/tcache.c:914:6: error: ‘struct global_info’ has no member named ‘max_global_limit’
     g->max_global_limit = totalram_pages - FREE_RAM_THRESH; 
      ^
/home/deba/tmem_module/tcache.c:907:15: warning: unused variable ‘ret’ [-Wunused-variable]
     int i = 0,ret;
               ^
/home/deba/tmem_module/tcache.c:907:9: warning: unused variable ‘i’ [-Wunused-variable]
     int i = 0,ret;
         ^
In file included from /home/deba/tmem_module/tcache.c:5:0:
/home/deba/tmem_module/tcache.c: At top level:
/home/deba/tmem_module/utmem.h:92:28: warning: ‘new_tmem_client’ defined but not used [-Wunused-function]
 static struct tmem_client* new_tmem_client(struct kvm *kvm, struct global_info *g)
                            ^
/home/deba/tmem_module/utmem.h:126:12: warning: ‘destroy_tmem_client’ defined but not used [-Wunused-function]
 static int destroy_tmem_client(struct kvm *kvm, struct global_info *g)
            ^
/home/deba/tmem_module/utmem.h:142:29: warning: ‘alloc_global’ defined but not used [-Wunused-function]
 static struct global_info * alloc_global(void)
                             ^
/home/deba/tmem_module/tcache.c:898:28: warning: ‘utmem_hostops’ defined but not used [-Wunused-variable]
 static struct tmem_hostops utmem_hostops = {
                            ^
cc1: some warnings being treated as errors
make[2]: *** [/home/deba/tmem_module/tcache.o] Error 1
make[1]: *** [_module_/home/deba/tmem_module] Error 2
make[1]: Leaving directory `/home/deba/linux-4.1.3.changed'
make: *** [all] Error 2
